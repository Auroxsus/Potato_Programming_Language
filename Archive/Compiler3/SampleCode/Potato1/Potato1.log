Page   1  Potato1.stm

    LC  Object    Line  Source Line
------  --------  ----  -------------------------------------------------------------
0X0000               1  ;--------------------------------------------------------------
0X0000               2  ; Potato1.stm
0X0000               3  ;--------------------------------------------------------------
0X0000               4  ; SVC numbers
0X0000               5  SVC_DONOTHING          EQU       0D0                  ; force context switch
0X0000               6  SVC_TERMINATE          EQU       0D1
0X0000               7  SVC_READ_INTEGER       EQU       0D10
0X0000               8  SVC_WRITE_INTEGER      EQU       0D11
0X0000               9  SVC_READ_FLOAT         EQU       0D20
0X0000              10  SVC_WRITE_FLOAT        EQU       0D21
0X0000              11  SVC_READ_BOOLEAN       EQU       0D30
0X0000              12  SVC_WRITE_BOOLEAN      EQU       0D31
0X0000              13  SVC_READ_CHARACTER     EQU       0D40
0X0000              14  SVC_WRITE_CHARACTER    EQU       0D41
0X0000              15  SVC_WRITE_ENDL         EQU       0D42
0X0000              16  SVC_READ_STRING        EQU       0D50
0X0000              17  SVC_WRITE_STRING       EQU       0D51
0X0000              18  SVC_INITIALIZE_HEAP    EQU       0D90
0X0000              19  SVC_ALLOCATE_BLOCK     EQU       0D91
0X0000              20  SVC_DEALLOCATE_BLOCK   EQU       0D92
0X0000              21  
0X0000              22                         ORG       0X0000
0X0000              23  
0X0000  800003      24                         JMP       PROGRAMMAIN
0X0003              25  ;    1 ||------------------------------------------------------------
0X0003              26  ;    2 || Auroxsus
0X0003              27  ;    3 || Description: sample print statments
0X0003              28  ;    4 || Potato1.p
0X0003              29  ;    5 ||------------------------------------------------------------
0X0003              30  ;    6 crisp mainCrisp () {
0X0003              31  ;    7    
0X0003              32  ; **** =========
0X0003              33  ; **** PROGRAM module (   6)
0X0003              34  ; **** =========
0X0003              35  PROGRAMMAIN            EQU       *
0X0003  0100FFFE    36                         PUSH      #RUNTIMESTACK        ; set SP
0X0007  0A          37                         POPSP     
0X0008  020100E7    38                         PUSHA     STATICDATA           ; set SB
0X000C  0C          39                         POPSB     
0X000D  010002F3    40                         PUSH      #HEAPBASE            ; initialize heap
0X0011  01002000    41                         PUSH      #HEAPSIZE
0X0015  FF005A      42                         SVC       #SVC_INITIALIZE_HEAP
0X0018  A0002C      43                         CALL      PROGRAMBODY0010
0X001B  020A0000    44                         PUSHA     SB:0D0
0X001F  FF0033      45                         SVC       #SVC_WRITE_STRING
0X0022  FF002A      46                         SVC       #SVC_WRITE_ENDL
0X0025  01000000    47                         PUSH      #0D0                 ; terminate with status = 0
0X0029  FF0001      48                         SVC       #SVC_TERMINATE
0X002C              49  PROGRAMBODY0010        EQU       *
0X002C              50  ;    8    || example 1: Simple string with newline escape sequence
0X002C              51  ;    9    bite "\"What's up, spud!\"\n";
0X002C              52  ;   10 
0X002C              53  ;   11    || example 2: Concatenated string with spaces and punctuation
0X002C              54  ; **** PRINT statement (   9)
0X002C              55  ;   12    bite "\"Potatos", " are ", "great!\"", ENDL;
0X002C  020A001C    56                         PUSHA     SB:0D28
Page   2  Potato1.stm

    LC  Object    Line  Source Line
------  --------  ----  -------------------------------------------------------------
0X0030  FF0033      57                         SVC       #SVC_WRITE_STRING
0X0033              58  ; **** PRINT statement (  12)
0X0033  020A0034    59                         PUSHA     SB:0D52
0X0037  FF0033      60                         SVC       #SVC_WRITE_STRING
0X003A  020A003F    61                         PUSHA     SB:0D63
0X003E  FF0033      62                         SVC       #SVC_WRITE_STRING
0X0041              63  ;   13 
0X0041              64  ;   14    || example 3: Mixing escape sequences for formatting
0X0041  020A0046    65                         PUSHA     SB:0D70
0X0045  FF0033      66                         SVC       #SVC_WRITE_STRING
0X0048              67  ;   15    bite "\"Menu:\tPotato Fries\n\tPotato Wedges\n\tMashed Potatoes\"", ENDL;
0X0048  FF002A      68                         SVC       #SVC_WRITE_ENDL
0X004B              69  ; **** PRINT statement (  15)
0X004B              70  ;   16 
0X004B              71  ;   17    || example 4: Using single quotes for a simple message
0X004B  020A0050    72                         PUSHA     SB:0D80
0X004F  FF0033      73                         SVC       #SVC_WRITE_STRING
0X0052              74  ;   18    bite "'Potatoes are life!'", ENDL;
0X0052  FF002A      75                         SVC       #SVC_WRITE_ENDL
0X0055              76  ; **** PRINT statement (  18)
0X0055              77  ;   19 
0X0055              78  ;   20    || example 5: Currency or symbol within a message
0X0055  020A008D    79                         PUSHA     SB:0D141
0X0059  FF0033      80                         SVC       #SVC_WRITE_STRING
0X005C              81  ;   21    bite "\"Price per lb: $4.99\"", ENDL;
0X005C  FF002A      82                         SVC       #SVC_WRITE_ENDL
0X005F              83  ; **** PRINT statement (  21)
0X005F              84  ;   22 
0X005F              85  ;   23    || example 6: Sentence split across multiple `bite` statements
0X005F  020A00A3    86                         PUSHA     SB:0D163
0X0063  FF0033      87                         SVC       #SVC_WRITE_STRING
0X0066              88  ;   24    bite "\"Let's\"";
0X0066  FF002A      89                         SVC       #SVC_WRITE_ENDL
0X0069              90  ;   25    bite " ", "\"grow\"";
0X0069              91  ; **** PRINT statement (  24)
0X0069  020A00BC    92                         PUSHA     SB:0D188
0X006D  FF0033      93                         SVC       #SVC_WRITE_STRING
0X0070              94  ; **** PRINT statement (  25)
0X0070              95  ;   26    bite " ", "\"potatoes!\"", ENDL;
0X0070  020A00C7    96                         PUSHA     SB:0D199
0X0074  FF0033      97                         SVC       #SVC_WRITE_STRING
0X0077  020A00CA    98                         PUSHA     SB:0D202
0X007B  FF0033      99                         SVC       #SVC_WRITE_STRING
0X007E             100  ; **** PRINT statement (  26)
0X007E  020A00D4   101                         PUSHA     SB:0D212
0X0082  FF0033     102                         SVC       #SVC_WRITE_STRING
0X0085             103  ;   27 
0X0085             104  ;   28 }
0X0085  020A00D7   105                         PUSHA     SB:0D215
0X0089  FF0033     106                         SVC       #SVC_WRITE_STRING
0X008C             107  ;   29 
0X008C             108  ;   30 
0X008C  FF002A     109                         SVC       #SVC_WRITE_ENDL
0X008F  A1         110                         RETURN    
0X0090             111  ; **** =========
0X0090             112  ; **** END (  30)
Page   3  Potato1.stm

    LC  Object    Line  Source Line
------  --------  ----  -------------------------------------------------------------
0X0090             113  ; **** =========
0X0090             114  ;--------------------------------------------------------------
0X0090             115  ; Common subroutines
0X0090             116  ;--------------------------------------------------------------
0X0090             117  CHRIsInRange           EQU       *                    ; CHR,LB,UB,RA
0X0090  01040002   118                         PUSH      SP:0D2               ; CHR,LB,UB,RA,LB
0X0094  01040004   119                         PUSH      SP:0D4               ; CHR,LB,UB,RA,LB,CHR
0X0098  70         120                         CMPI                           ; CHR,LB,UB,RA (set LEG)
0X0099  8300B8     121                         JMPG      F0030                ; CHR,LB,UB,RA
0X009C  01040003   122                         PUSH      SP:0D3               ; CHR,LB,UB,RA,CHR
0X00A0  01040002   123                         PUSH      SP:0D2               ; CHR,LB,UB,RA,CHR,UB
0X00A4  70         124                         CMPI                           ; CHR,LB,UB,RA (set LEG)
0X00A5  8300B8     125                         JMPG      F0030                ; CHR,LB,UB,RA
0X00A8             126  T0020                  EQU       *                    ; CHR,LB,UB,RA
0X00A8  05         127                         SWAP                           ; CHR,LB,RA,UB
0X00A9  040001     128                         DISCARD   #0D1                 ; CHR,LB,RA
0X00AC  05         129                         SWAP                           ; CHR,RA,LB
0X00AD  040001     130                         DISCARD   #0D1                 ; CHR,RA
0X00B0  0100FFFF   131                         PUSH      #0XFFFF              ; CHR,RA,true
0X00B4  05         132                         SWAP                           ; CHR,true,RA
0X00B5  8000C5     133                         JMP       E0040                ; CHR,true,RA
0X00B8             134  F0030                  EQU       *                    ; CHR,LB,UB,RA
0X00B8  05         135                         SWAP                           ; CHR,LB,RA,UB
0X00B9  040001     136                         DISCARD   #0D1                 ; CHR,LB,RA
0X00BC  05         137                         SWAP                           ; CHR,RA,LB
0X00BD  040001     138                         DISCARD   #0D1                 ; CHR,RA
0X00C0  01000000   139                         PUSH      #0X0000              ; CHR,RA,false
0X00C4  05         140                         SWAP                           ; CHR,false,RA
0X00C5             141  E0040                  EQU       *                    ; CHR,true-or-false,RA
0X00C5  A1         142                         RETURN                         ; CHR,true-or-false,RA
0X00C6             143  ;------------------------------------------------------------
0X00C6             144  ; Issue "Run-time error #X..X near line #X..X" to handle run-time errors
0X00C6             145  ;------------------------------------------------------------
0X00C6             146  HANDLERUNTIMEERROR     EQU       *
0X00C6  FF002A     147                         SVC       #SVC_WRITE_ENDL
0X00C9  020A00E6   148                         PUSHA     SB:0D230
0X00CD  FF0033     149                         SVC       #SVC_WRITE_STRING
0X00D0  FF000B     150                         SVC       #SVC_WRITE_INTEGER
0X00D3  020A00F8   151                         PUSHA     SB:0D248
0X00D7  FF0033     152                         SVC       #SVC_WRITE_STRING
0X00DA  FF000B     153                         SVC       #SVC_WRITE_INTEGER
0X00DD  FF002A     154                         SVC       #SVC_WRITE_ENDL
0X00E0  01000001   155                         PUSH      #0D1
0X00E4  FF0001     156                         SVC       #SVC_TERMINATE
0X00E7             157  ;------------------------------------------------------------
0X00E7             158  ; Static allocation of global data and PROGRAM module data
0X00E7             159  ;------------------------------------------------------------
0X00E7             160  STATICDATA             EQU       *
0X00E7  001A001A   161                         DS        "Normal program termination"
0X00EB  004E006F
0X00EF  0072006D
0X00F3  0061006C
0X00F7  00200070
0X00FB  0072006F
0X00FF  00670072
0X0103  0061006D
Page   4  Potato1.stm

    LC  Object    Line  Source Line
------  --------  ----  -------------------------------------------------------------
0X0107  00200074
0X010B  00650072
0X010F  006D0069
0X0113  006E0061
0X0117  00740069
0X011B  006F006E
0X011F  00160016   162                         DS        "\"What's up, spud!\"\n"
0X0123  005C0022
0X0127  00570068
0X012B  00610074
0X012F  00270073
0X0133  00200075
0X0137  0070002C
0X013B  00200073
0X013F  00700075
0X0143  00640021
0X0147  005C0022
0X014B  005C006E
0X014F  00090009   163                         DS        "\"Potatos"
0X0153  005C0022
0X0157  0050006F
0X015B  00740061
0X015F  0074006F
0X0163  0073    
0X0165  00050005   164                         DS        " are "
0X0169  00200061
0X016D  00720065
0X0171  0020    
0X0173  00080008   165                         DS        "great!\""
0X0177  00670072
0X017B  00650061
0X017F  00740021
0X0183  005C0022
0X0187  003B003B   166                         DS        "\"Menu:\tPotato Fries\n\tPotato Wedges\n\tMashed Potatoes\""
0X018B  005C0022
0X018F  004D0065
0X0193  006E0075
0X0197  003A005C
0X019B  00740050
0X019F  006F0074
0X01A3  00610074
0X01A7  006F0020
0X01AB  00460072
0X01AF  00690065
0X01B3  0073005C
0X01B7  006E005C
0X01BB  00740050
0X01BF  006F0074
0X01C3  00610074
0X01C7  006F0020
0X01CB  00570065
0X01CF  00640067
0X01D3  00650073
0X01D7  005C006E
0X01DB  005C0074
0X01DF  004D0061
Page   5  Potato1.stm

    LC  Object    Line  Source Line
------  --------  ----  -------------------------------------------------------------
0X01E3  00730068
0X01E7  00650064
0X01EB  00200050
0X01EF  006F0074
0X01F3  00610074
0X01F7  006F0065
0X01FB  0073005C
0X01FF  0022    
0X0201  00140014   167                         DS        "'Potatoes are life!'"
0X0205  00270050
0X0209  006F0074
0X020D  00610074
0X0211  006F0065
0X0215  00730020
0X0219  00610072
0X021D  00650020
0X0221  006C0069
0X0225  00660065
0X0229  00210027
0X022D  00170017   168                         DS        "\"Price per lb: $4.99\""
0X0231  005C0022
0X0235  00500072
0X0239  00690063
0X023D  00650020
0X0241  00700065
0X0245  00720020
0X0249  006C0062
0X024D  003A0020
0X0251  00240034
0X0255  002E0039
0X0259  0039005C
0X025D  0022    
0X025F  00090009   169                         DS        "\"Let's\""
0X0263  005C0022
0X0267  004C0065
0X026B  00740027
0X026F  0073005C
0X0273  0022    
0X0275  00010001   170                         DS        " "
0X0279  0020    
0X027B  00080008   171                         DS        "\"grow\""
0X027F  005C0022
0X0283  00670072
0X0287  006F0077
0X028B  005C0022
0X028F  00010001   172                         DS        " "
0X0293  0020    
0X0295  000D000D   173                         DS        "\"potatoes!\""
0X0299  005C0022
0X029D  0070006F
0X02A1  00740061
0X02A5  0074006F
0X02A9  00650073
0X02AD  0021005C
0X02B1  0022    
0X02B3  00100010   174                         DS        "Run-time error #"
Page   6  Potato1.stm

    LC  Object    Line  Source Line
------  --------  ----  -------------------------------------------------------------
0X02B7  00520075
0X02BB  006E002D
0X02BF  00740069
0X02C3  006D0065
0X02C7  00200065
0X02CB  00720072
0X02CF  006F0072
0X02D3  00200023
0X02D7  000C000C   175                         DS        " near line #"
0X02DB  0020006E
0X02DF  00650061
0X02E3  00720020
0X02E7  006C0069
0X02EB  006E0065
0X02EF  00200023
0X02F3             176  ;------------------------------------------------------------
0X02F3             177  ; Heap space for dynamic memory allocation (to support future SPL syntax)
0X02F3             178  ;------------------------------------------------------------
0X02F3             179  HEAPBASE               EQU       *
0X02F3             180  HEAPSIZE               EQU       0B0010000000000000   ; 8K bytes = 4K words
0X02F3             181  ;------------------------------------------------------------
0X02F3             182  ; Run-time stack
0X02F3             183  ;------------------------------------------------------------
0X02F3             184  RUNTIMESTACK           EQU       0XFFFE


  PC   SP TOS0 TOS1 TOS2 mnemonic  information
---- ---- ---- ---- ---- --------- ----------------------------------------------
0000 FFFE                 JMP       0X0003
0003 FFFE                 PUSH      #memory[EA = 0X0005] = 0XFFFE
0007 FFFC FFFE            POPSP     SP = 0XFFFE
0008 FFFE                 PUSHA     memory[EA = 0X00E7]
000C FFFC 00E7            POPSB     SB = 0X00E7
000D FFFE                 PUSH      #memory[EA = 0X000F] = 0X02F3
0011 FFFC 02F3            PUSH      #memory[EA = 0X0013] = 0X2000
-------------------------------------------------------------
FREE nodes list
   0X02F3:0X22F2(0X1FFC)
-------------------------------------------------------------
0015 FFFA 2000 02F3       SVC       #90 initialize heap, heapBase = 0X02F3, heapSize = 0X2000 words
0018 FFFE                 CALL      0X002C return to 0X001B
002C FFFC 001B            PUSHA     SB( 28) memory[EA = 0X011F]
"What's up, spud!"
0030 FFFA 011F 001B       SVC       #51 write string
0033 FFFC 001B            PUSHA     SB( 52) memory[EA = 0X014F]
0037 FFFA 014F 001B       SVC       #51 write string
003A FFFC 001B            PUSHA     SB( 63) memory[EA = 0X0165]
003E FFFA 0165 001B       SVC       #51 write string
0041 FFFC 001B            PUSHA     SB( 70) memory[EA = 0X0173]
0045 FFFA 0173 001B       SVC       #51 write string
"Potatos are great!"
0048 FFFC 001B            SVC       #42 write ENDL
004B FFFC 001B            PUSHA     SB( 80) memory[EA = 0X0187]
"Menu:	Potato Fries
	Potato Wedges
004F FFFA 0187 001B       SVC       #51 write string
	Mashed Potatoes"
0052 FFFC 001B            SVC       #42 write ENDL
0055 FFFC 001B            PUSHA     SB(141) memory[EA = 0X0201]
0059 FFFA 0201 001B       SVC       #51 write string
'Potatoes are life!'
005C FFFC 001B            SVC       #42 write ENDL
005F FFFC 001B            PUSHA     SB(163) memory[EA = 0X022D]
0063 FFFA 022D 001B       SVC       #51 write string
"Price per lb: $4.99"
0066 FFFC 001B            SVC       #42 write ENDL
0069 FFFC 001B            PUSHA     SB(188) memory[EA = 0X025F]
006D FFFA 025F 001B       SVC       #51 write string
0070 FFFC 001B            PUSHA     SB(199) memory[EA = 0X0275]
0074 FFFA 0275 001B       SVC       #51 write string
0077 FFFC 001B            PUSHA     SB(202) memory[EA = 0X027B]
007B FFFA 027B 001B       SVC       #51 write string
007E FFFC 001B            PUSHA     SB(212) memory[EA = 0X028F]
0082 FFFA 028F 001B       SVC       #51 write string
0085 FFFC 001B            PUSHA     SB(215) memory[EA = 0X0295]
0089 FFFA 0295 001B       SVC       #51 write string
"Let's" "grow" "potatoes!"
008C FFFC 001B            SVC       #42 write ENDL
008F FFFC 001B            RETURN    to 0X001B
001B FFFE                 PUSHA     SB(  0) memory[EA = 0X00E7]
001F FFFC 00E7            SVC       #51 write string
Normal program termination
0022 FFFE                 SVC       #42 write ENDL
0025 FFFE                 PUSH      #memory[EA = 0X0027] = 0X0000
0029 FFFC 0000            SVC       #1 terminate program with status 0, SP = 0XFFFE

